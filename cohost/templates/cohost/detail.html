{% extends 'base.html' %}
{% load crispy_forms_tags %}

{%block mod_content%}
<!-- <h1 class="page-header">数据</h1> -->
<!-- <table class="table ">
    <thead>
        <tr>
            <td>ip</td>
            <td>host</td>
            <td>审核状态</td>
            <td>标题</td>
            <td>类别</td>
            <td>接入商</td>
            <td>站点状态</td>
            <td>备案号</td>
            <td>主办单位</td>
            <td>区域</td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>{{object.ip}}</td>
            <td><a href="http://{{object.uri}}" target="_blank">{{object.uri}}</a></td>
            <td>{{object.get_state_display}}</td>
            <td>{{object.title}}</td>
            <td>{{object.cate|default:""}}</td>
            <td>{{object.IPS|default:""}}</td>
            <td id="J-Site-Status"><span >等待...</span><span id="J-Success-Site"class="hidden">正常</span><span class="hidden" id="J-Error-Site">异常</span> </td>
            <td>{{object.icpno|default:''}}</td>
            <td>{{object.organizers|default:""}}</td>
            <td>{{d.area.name|default:''}}</td>
        </tr>
    </tbody>
</table> -->

 <div class="panel-group" id="accordion">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#collapse-{{obj.id}}">
              编辑选项
              </a>
            </h4>
          </div>
          <div id="collapse-{{obj.id}}" class="panel-collapse collapse in">
            <div class="panel-body">
                    {% crispy form form.helper %}
            </div>
          </div>
        </div>

  </div> 

{%block jsset %}
    
<script type="text/javascript">
        $('.collapse').collapse()
        var serverUrl = "http://{{object.uri}}"
        $.ajax(serverUrl, {
           type: "GET",
           dataType: 'jsonp',
           statusCode: {
              200: function (response) {
                $('#J-Site-Status span').addClass("hidden")
                $('#J-Success-Site').removeClass("hidden")

              },
              400: function (response) {
                $('#J-Site-Status span').addClass("hidden")
                $('#J-Error-Site').removeClass("hidden")
              },
              404: function (response) {
                $('#J-Site-Status span').addClass("hidden")
                $('#J-Error-Site').removeClass("hidden")

              }
           }, 
           error: function(){
               $('#J-Site-Status span').addClass("hidden")
               $('#J-Error-Site').removeClass("hidden")
            },
           success: function () {

           },
           timeout: 3000 
        });
    </script>
{%endblock%}

{%endblock%}